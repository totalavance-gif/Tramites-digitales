<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ADMIN</title>

<style>
body{
  font-family:Arial;
  background:#f5f8fa;
  padding:15px;
}
h2{margin-top:30px}
input,select,button{
  width:100%;
  padding:10px;
  margin-top:8px;
}
button{
  background:#1da1f2;
  color:#fff;
  border:none;
  border-radius:8px;
}
hr{margin:30px 0}
</style>
</head>

<body>

<h1>ğŸ” Panel Administrador</h1>

<!-- ğŸ”” AVISOS -->
<h2>ğŸ“¢ Crear AVISO</h2>

<input id="avisoTexto" placeholder="Texto del aviso">
<select id="avisoTipo">
  <option value="info">InformaciÃ³n</option>
  <option value="alerta">Alerta</option>
</select>

<button id="btnAviso">Publicar aviso</button>
<p id="estadoAviso"></p>

<hr>

<!-- ğŸ“ POSTS -->
<h2>ğŸ“ Crear PUBLICACIÃ“N</h2>

<input id="texto" placeholder="Texto de la publicaciÃ³n">
<input id="precio" placeholder="Precio (opcional)">
<input type="file" id="imagen">

<select id="tipo">
  <option value="ventas">Ventas</option>
  <option value="noticias">Noticias</option>
</select>

<button id="btnPost">Publicar</button>
<p id="estado"></p>

<!-- ğŸ”¥ FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp }
from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";
import { getStorage, ref, uploadBytes, getDownloadURL }
from "https://www.gstatic.com/firebasejs/12.8.0/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSyCpZGsRlW_Vr9vJrlv4nCmJi7VDscld8Yw",
  authDomain: "tramites-a993f.firebaseapp.com",
  projectId: "tramites-a993f",
  storageBucket: "tramites-a993f.firebasestorage.app",
  messagingSenderId: "363617051453",
  appId: "1:363617051453:web:a5c46549c4057b06f51b54"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const storage = getStorage(app);

/* ğŸ”” AVISOS */
document.getElementById("btnAviso").onclick = async ()=>{
  estadoAviso.innerText = "Publicando aviso...";
  await addDoc(collection(db,"avisos"),{
    texto: avisoTexto.value,
    tipo: avisoTipo.value,
    fecha: serverTimestamp()
  });
  estadoAviso.innerText = "âœ… Aviso publicado";
  avisoTexto.value="";
};

/* ğŸ“ POSTS */
document.getElementById("btnPost").onclick = async ()=>{
  estado.innerText="Subiendo...";
  let imgURL="";

  if(imagen.files[0]){
    const imgRef = ref(storage,"img/"+Date.now());
    await uploadBytes(imgRef,imagen.files[0]);
    imgURL = await getDownloadURL(imgRef);
  }

  await addDoc(collection(db,"posts"),{
    texto:texto.value,
    precio:precio.value,
    tipo:tipo.value,
    imagen:imgURL,
    fecha:serverTimestamp()
  });

  estado.innerText="âœ… Publicado";
  texto.value="";
  precio.value="";
};
</script>

</body>
</html>
