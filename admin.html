<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin</title>

<style>
body{font-family:Arial;background:#f2f2f2;padding:15px}
.card{background:#fff;padding:15px;border-radius:10px;margin-bottom:15px}
input,textarea,select,button{width:100%;padding:10px;margin-top:8px}
button{background:#1da1f2;color:#fff;border:none;border-radius:6px}
</style>
</head>

<body>

<div class="card" id="login">
  <input type="password" id="pass" placeholder="Contraseña">
  <button onclick="login()">Entrar</button>
</div>

<div id="panel" style="display:none">

<div class="card">
  <select id="tipo">
    <option value="ventas">Venta</option>
    <option value="noticias">Noticia</option>
  </select>
  <input id="precio" placeholder="Precio">
  <input type="file" id="img" accept="image/*">
  <textarea id="texto" placeholder="Descripción"></textarea>
  <button onclick="guardar()">Publicar</button>
</div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

const CLAVE = "admin123";

function login(){
  if(document.getElementById("pass").value === CLAVE){
    login.style.display="none";
    panel.style.display="block";
  } else alert("Clave incorrecta");
}
window.login = login;

const firebaseConfig = {
  apiKey: "TU_API_KEY",
  authDomain: "TU_AUTH_DOMAIN",
  projectId: "TU_PROJECT_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.guardar = async ()=>{
  const texto = texto.value;
  if(!texto) return alert("Escribe algo");

  let imagen = "";
  if(img.files[0]){
    const r = new FileReader();
    r.onload = async ()=>{
      imagen = r.result;
      await subir(imagen);
    };
    r.readAsDataURL(img.files[0]);
  } else subir("");

  async function subir(im){
    await addDoc(collection(db,"posts"),{
      tipo: tipo.value,
      texto,
      precio: precio.value,
      imagen: im,
      fecha: serverTimestamp()
    });
    alert("Publicado");
    texto.value="";precio.value="";img.value="";
  }
};
</script>

</body>
</html>
