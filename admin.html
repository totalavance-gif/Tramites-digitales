<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panel Administrador</title>

<style>
body{
  font-family:Arial, sans-serif;
  background:#f2f5f8;
  padding:15px;
}
.card{
  background:#fff;
  padding:15px;
  border-radius:10px;
  margin-bottom:15px;
}
input, textarea, select, button{
  width:100%;
  padding:10px;
  margin-top:8px;
  border-radius:8px;
  border:1px solid #ccc;
}
button{
  background:#1da1f2;
  color:#fff;
  border:none;
  font-size:16px;
}
.ok{color:green;margin-top:8px}
#panel{display:none}
</style>
</head>

<body>

<h2>üîê Panel Administrador</h2>

<!-- LOGIN -->
<div class="card" id="login">
  <input type="password" id="password" placeholder="Contrase√±a">
  <button onclick="login()">Entrar</button>
</div>

<!-- PANEL -->
<div id="panel">

  <!-- AVISOS -->
  <div class="card">
    <h3>üì¢ Crear AVISO</h3>
    <textarea id="avisoTexto" placeholder="Texto del aviso"></textarea>
    <select id="avisoTipo">
      <option value="info">Informaci√≥n</option>
      <option value="alerta">Alerta</option>
    </select>
    <button onclick="publicarAviso()">Publicar aviso</button>
    <div class="ok" id="avisoOk"></div>
  </div>

  <!-- PUBLICACIONES -->
  <div class="card">
    <h3>üìù Crear PUBLICACI√ìN</h3>
    <textarea id="texto" placeholder="Texto de la publicaci√≥n"></textarea>
    <input id="precio" placeholder="Precio (opcional)">
    <input type="file" id="imagen">
    <select id="tipo">
      <option value="ventas">Ventas</option>
      <option value="noticias">Noticias</option>
    </select>
    <button onclick="publicar()">Publicar</button>
  </div>

</div>

<!-- üî• FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp }
from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCpZGsRlW_Vr9vJrlv4nCmJi7VDscld8Yw",
  authDomain: "tramites-a993f.firebaseapp.com",
  projectId: "tramites-a993f",
  storageBucket: "tramites-a993f.firebasestorage.app",
  messagingSenderId: "363617051453",
  appId: "1:363617051453:web:a5c46549c4057b06f51b54"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// üîë CONTRASE√ëA
const CLAVE = "admin123";

window.login = function(){
  if(password.value === CLAVE){
    login.style.display="none";
    panel.style.display="block";
  }else{
    alert("Contrase√±a incorrecta");
  }
};

// AVISO
window.publicarAviso = async function(){
  await addDoc(collection(db,"avisos"),{
    texto: avisoTexto.value,
    tipo: avisoTipo.value,
    fecha: serverTimestamp()
  });
  avisoOk.innerText = "‚úÖ Aviso publicado";
  avisoTexto.value="";
};

// PUBLICACI√ìN
window.publicar = async function(){
  let img="";
  if(imagen.files[0]){
    img = await new Promise(r=>{
      const fr=new FileReader();
      fr.onload=()=>r(fr.result);
      fr.readAsDataURL(imagen.files[0]);
    });
  }

  await addDoc(collection(db,"posts"),{
    texto:texto.value,
    precio:precio.value,
    tipo:tipo.value,
    imagen:img,
    fecha:serverTimestamp()
  });

  texto.value="";
  precio.value="";
  imagen.value="";
  alert("Publicaci√≥n creada");
};
</script>

</body>
</html>
